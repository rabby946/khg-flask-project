{% extends "member/base.html" %}

{% block title %}Edit Profile{% endblock %}

{% block member_content %}
<style>
    /* Scoped styles for the Edit Profile page */
    :root {
        --edit-font: 'Poppins', sans-serif;
        --edit-primary: #0d6efd;
        --edit-card-bg: #ffffff;
        --edit-border: #dee2e6;
        --edit-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
        --edit-text-dark: #212529;
        --edit-text-light: #6c757d;
        --edit-photo-bg: #f8f9fa;
    }
    .edit-profile-container { max-width: 900px; margin: 1rem auto; font-family: var(--edit-font); }
    .profile-card {
        background-color: var(--edit-card-bg);
        border: 1px solid var(--edit-border);
        border-radius: 1rem;
        box-shadow: var(--edit-shadow);
        overflow: hidden;
        display: grid;
        grid-template-columns: 1fr;
    }
    @media (min-width: 992px) { .profile-card { grid-template-columns: 300px 1fr; } }
    .profile-photo-section { background-color: var(--edit-photo-bg); padding: 2.5rem; display: flex; flex-direction: column; align-items: center; justify-content: center; border-bottom: 1px solid var(--edit-border); }
    @media (min-width: 992px) { .profile-photo-section { border-bottom: none; border-right: 1px solid var(--edit-border); } }
    .profile-photo-preview { width: 150px; height: 150px; border-radius: 50%; object-fit: cover; margin-bottom: 1.5rem; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border: 4px solid #fff; }
    .change-photo-btn { background-color: #fff; color: var(--edit-text-dark); border: 1px solid var(--edit-border); padding: 0.5rem 1rem; border-radius: 50px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; }
    .change-photo-btn:hover { background-color: var(--edit-primary); color: #fff; border-color: var(--edit-primary); }
    #photo_url { display: none; }
    .profile-form-section { padding: 2.5rem; }
    .form-header { margin-bottom: 2rem; }
    .form-title { font-size: 1.75rem; font-weight: 600; color: var(--edit-text-dark); }
    .form-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }
    @media (min-width: 768px) { .form-grid { grid-template-columns: 1fr 1fr; } .col-full { grid-column: 1 / -1; } }
    .form-group label { font-weight: 500; margin-bottom: 0.5rem; display: block; }
    .form-control { width: 100%; padding: 0.8rem 1rem; font-size: 1rem; border-radius: 0.5rem; border: 1px solid var(--edit-border); transition: border-color 0.2s, box-shadow 0.2s; }
    .form-control:focus { border-color: var(--edit-primary); box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25); outline: none; }
    .form-actions { margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid var(--edit-border); text-align: right; }
    .submit-btn { padding: 0.8rem 2rem; font-size: 1rem; font-weight: 600; border-radius: 0.5rem; background-color: var(--edit-primary); color: #fff; border: none; cursor: pointer; transition: background-color 0.2s ease; }
    .submit-btn:hover { background-color: #0b5ed7; }
</style>

<div class="edit-profile-container">
    <form method="POST" enctype="multipart/form-data">
        <div class="profile-card">
            <div class="profile-photo-section">
                <img src="{{ member.photo_url or 'https://via.placeholder.com/150' }}" alt="Profile Photo" class="profile-photo-preview" id="photo-preview">
                <input type="file" id="photo_url" name="photo_url" accept="image/*">
                <button type="button" class="change-photo-btn" id="change-photo-button">
                    <i class="fas fa-camera me-2"></i>Change Photo
                </button>
            </div>

            <div class="profile-form-section">
                <div class="form-header">
                    <h2 class="form-title">Your Profile</h2>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="name" class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="name" name="name" value="{{ member.name }}" required>
                    </div>
                    <div class="form-group">
                        <label for="father_name" class="form-label">Father's Name</label>
                        <input type="text" class="form-control" id="father_name" name="father_name" value="{{ member.father_name }}">
                    </div>
                    <div class="form-group">
                        <label for="email" class="form-label">Email Address</label>
                        <input type="email" class="form-control" id="email" name="email" value="{{ member.email }}">
                    </div>
                    <div class="form-group">
                        <label for="phone" class="form-label">Phone Number</label>
                        <input type="text" class="form-control" id="phone" name="phone" value="{{ member.phone }}">
                    </div>
                    <div class="form-group col-full">
                        <label for="address" class="form-label">Address</label>
                        <input type="text" class="form-control" id="address" name="address" value="{{ member.address }}">
                    </div>
                    <div class="form-group">
                        <label for="gender" class="form-label">Gender</label>
                        <select class="form-control" id="gender" name="gender">
                            <option value="">Select Gender</option>
                            <option value="Male" {% if member.gender=='Male' %}selected{% endif %}>Male</option>
                            <option value="Female" {% if member.gender=='Female' %}selected{% endif %}>Female</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="date_of_birth" class="form-label">Date of Birth</label>
                        <input type="date" class="form-control" id="date_of_birth" name="date_of_birth" value="{{ member.date_of_birth.strftime('%Y-%m-%d') if member.date_of_birth else '' }}">
                    </div>
                    <div class="form-group col-full">
                        <label for="occupation" class="form-label">Occupation</label>
                        <input type="text" class="form-control" id="occupation" name="occupation" value="{{ member.occupation }}">
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="submit-btn">Update Profile</button>
                </div>
            </div>
        </div>
    </form> </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const changePhotoButton = document.getElementById('change-photo-button');
    const photoInput = document.getElementById('photo_url');
    const photoPreview = document.getElementById('photo-preview');

    changePhotoButton.addEventListener('click', () => {
        photoInput.click();
    });

    photoInput.addEventListener('change', (event) => {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                photoPreview.src = e.target.result;
            }
            reader.readAsDataURL(file);
        }
    });
});
</script>
{% endblock %}